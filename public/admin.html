<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Little Treasures Admin Panel</title>
<style>
body { font-family: Arial, sans-serif; background: #f4f4f4; margin: 0; }
header { background: #4ecdc4; padding: 1rem; color: white; text-align: center; }
.container { max-width: 1000px; margin: auto; padding: 20px; }
.hidden { display: none; }
button { padding: 0.5rem 1rem; margin: 0.5rem 0; cursor: pointer; }
input, select, textarea { width: 100%; padding: 0.5rem; margin: 0.5rem 0; }
.card { background: white; padding: 1rem; margin-bottom: 1rem; border-radius: 8px; }
</style>
</head>
<body>
<header>Admin Panel - Little Treasures</header>
<div class="container">
    <div id="loginSection">
        <h2>Admin Login</h2>
        <input type="email" id="adminEmail" placeholder="Email">
        <input type="password" id="adminPassword" placeholder="Password">
        <button onclick="adminLogin()">Login</button>
        <div id="loginError" style="color:red"></div>
    </div>
    <div id="dashboardSection" class="hidden">
        <h2>Dashboard</h2>
        <button onclick="showTab('productsTab')">Manage Products</button>
        <button onclick="showTab('ordersTab')">Manage Orders</button>
        <div id="productsTab" class="hidden card">
            <h3>Add Product</h3>
            <input type="text" id="productName" placeholder="Name">
            <input type="number" id="productPrice" placeholder="Price">
            <input type="number" id="productStock" placeholder="Stock">
            <select id="productCategory">
                <option value="stationery">Stationery</option>
                <option value="bags">Bags</option>
                <option value="accessories">Accessories</option>
            </select>
            <textarea id="productDescription" placeholder="Description"></textarea>
            <button onclick="addProduct()">Add</button>
            <h3>Inventory</h3>
            <div id="inventoryList"></div>
        </div>
        <div id="ordersTab" class="hidden card">
            <h3>Orders</h3>
            <div id="ordersList"></div>
        </div>
    </div>
</div>
<script>
let token = localStorage.getItem('adminToken');
const API_BASE = window.location.origin + '/api';
function showTab(tabId){
    document.querySelectorAll('#dashboardSection .card').forEach(el=>el.classList.add('hidden'));
    document.getElementById(tabId).classList.remove('hidden');
    if(tabId==='productsTab') loadProducts();
    if(tabId==='ordersTab') loadOrders();
}
async function adminLogin(){
    const email = document.getElementById('adminEmail').value;
    const password = document.getElementById('adminPassword').value;
    const res = await fetch(API_BASE+'/admin/login',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({email,password})});
    const data = await res.json();
    if(res.ok){
        token = data.token;
        localStorage.setItem('adminToken', token);
        document.getElementById('loginSection').classList.add('hidden');
        document.getElementById('dashboardSection').classList.remove('hidden');
    } else {
        document.getElementById('loginError').textContent = data.error || 'Login failed';
    }
}
async function addProduct(){
    const name=document.getElementById('productName').value;
    const price=document.getElementById('productPrice').value;
    const stock=document.getElementById('productStock').value;
    const category=document.getElementById('productCategory').value;
    const description=document.getElementById('productDescription').value;
    await fetch(API_BASE+'/products',{method:'POST',headers:{'Content-Type':'application/json','Authorization':'Bearer '+token},body:JSON.stringify({name,price,stock,category,description,image:category==='stationery'?'✏️':category==='bags'?'🎒':'🌟'})});
    loadProducts();
}
async function loadProducts(){
    const res=await fetch(API_BASE+'/products');
    const data=await res.json();
    document.getElementById('inventoryList').innerHTML=data.map(p=>`<div>${p.name} - ₹${p.price} (${p.stock}) <button onclick="deleteProduct('${p._id}')">Delete</button></div>`).join('');
}
async function deleteProduct(id){
    await fetch(API_BASE+'/products/'+id,{method:'DELETE',headers:{'Authorization':'Bearer '+token}});
    loadProducts();
}
async function loadOrders(){
    const res=await fetch(API_BASE+'/orders',{headers:{'Authorization':'Bearer '+token}});
    const orders=await res.json();
    document.getElementById('ordersList').innerHTML=orders.map(o=>`<div>Order #${o.orderNumber} - ${o.status} - ₹${o.totalAmount}</div>`).join('');
}
</script>
</body>
</html>
